# CRITICAL SECURITY CONFIGURATION
# Copy this file to .env.local and fill in the values
# NEVER commit actual keys to version control

# ============================================
# API KEY ENCRYPTION (REQUIRED)
# ============================================
# Generate with: openssl rand -hex 32
# Must be at least 32 characters
API_KEY_ENCRYPTION_KEY=YOUR_32_CHARACTER_ENCRYPTION_KEY_HERE

# Backup encryption key (for key rotation)
API_KEY_ENCRYPTION_KEY_BACKUP=

# ============================================
# WEBHOOK SIGNATURE VERIFICATION (REQUIRED)
# ============================================
# Get from Stripe Dashboard > Webhooks
STRIPE_WEBHOOK_SECRET=whsec_

# Get from GoCardless Dashboard > Webhooks
GOCARDLESS_WEBHOOK_SECRET=

# ============================================
# RATE LIMITING CONFIGURATION
# ============================================
# Redis connection for distributed rate limiting
REDIS_URL=redis://localhost:6379

# Rate limit settings (requests per minute)
PAYMENT_RATE_LIMIT_GLOBAL=1000
PAYMENT_RATE_LIMIT_PER_IP=100
PAYMENT_RATE_LIMIT_PER_USER=50

# ============================================
# SECURITY MONITORING
# ============================================
# Sentry for error tracking
SENTRY_DSN=

# Security alert email
SECURITY_ALERT_EMAIL=security@yourdomain.com

# Slack webhook for critical alerts
SLACK_SECURITY_WEBHOOK=

# ============================================
# AUDIT LOGGING
# ============================================
# Separate database for audit logs (recommended)
AUDIT_DATABASE_URL=

# Log retention days
AUDIT_LOG_RETENTION_DAYS=365

# ============================================
# PAYMENT VALIDATION
# ============================================
# Maximum allowed payment amount (in pennies)
MAX_PAYMENT_AMOUNT=999999

# Suspicious payment threshold (in pennies)
SUSPICIOUS_PAYMENT_THRESHOLD=100000

# ============================================
# API KEY ROTATION
# ============================================
# Days before API key rotation reminder
API_KEY_ROTATION_DAYS=90

# Force rotation after days
API_KEY_FORCE_ROTATION_DAYS=180

# ============================================
# CORS CONFIGURATION
# ============================================
# Allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=https://login.gymleadhub.co.uk,https://members.gymleadhub.co.uk

# ============================================
# CONTENT SECURITY POLICY
# ============================================
CSP_REPORT_URI=https://yourdomain.report-uri.com/r/d/csp/enforce

# ============================================
# TESTING (NEVER USE IN PRODUCTION)
# ============================================
# Set to true to bypass security checks (DEVELOPMENT ONLY)
BYPASS_SECURITY_CHECKS=false

# Test mode for webhooks (logs but doesn't process)
WEBHOOK_TEST_MODE=false